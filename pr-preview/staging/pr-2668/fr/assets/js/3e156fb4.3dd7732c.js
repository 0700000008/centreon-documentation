"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[70098],{603905:(e,r,n)=>{n.d(r,{Zo:()=>p,kt:()=>f});var t=n(667294);function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function a(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?a(Object(n),!0).forEach((function(r){o(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function s(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)n=a[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)n=a[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=t.createContext({}),u=function(e){var r=t.useContext(l),n=r;return e&&(n="function"==typeof e?e(r):i(i({},r),e)),n},p=function(e){var r=u(e.components);return t.createElement(l.Provider,{value:r},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},m=t.forwardRef((function(e,r){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(n),m=o,f=c["".concat(l,".").concat(m)]||c[m]||d[m]||a;return n?t.createElement(f,i(i({ref:r},p),{},{components:n})):t.createElement(f,i({ref:r},p))}));function f(e,r){var n=arguments,o=r&&r.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var s={};for(var l in r)hasOwnProperty.call(r,l)&&(s[l]=r[l]);s.originalType=e,s[c]="string"==typeof e?e:o,i[1]=s;for(var u=2;u<a;u++)i[u]=n[u];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"},439222:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>p,contentTitle:()=>l,default:()=>f,frontMatter:()=>s,metadata:()=>u,toc:()=>c});n(667294);var t=n(603905);function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function a(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):function(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})),e}function i(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)n=a[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)n=a[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const s={id:"upgrade-from-centreon-failover",title:"Mont\xe9e de version de Centreon Failover vers Centreon HA"},l=void 0,u={unversionedId:"upgrade/centreon-ha/upgrade-from-centreon-failover",id:"version-21.10/upgrade/centreon-ha/upgrade-from-centreon-failover",title:"Mont\xe9e de version de Centreon Failover vers Centreon HA",description:"Pr\xe9requis",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-21.10/upgrade/centreon-ha/upgrade-from-centreon-failover.md",sourceDirName:"upgrade/centreon-ha",slug:"/upgrade/centreon-ha/upgrade-from-centreon-failover",permalink:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/centreon-ha/upgrade-from-centreon-failover",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/i18n/fr/docusaurus-plugin-content-docs/version-21.10/upgrade/centreon-ha/upgrade-from-centreon-failover.md",tags:[],version:"21.10",lastUpdatedAt:1698408292,formattedLastUpdatedAt:"27 oct. 2023",frontMatter:{id:"upgrade-from-centreon-failover",title:"Mont\xe9e de version de Centreon Failover vers Centreon HA"},sidebar:"version-21.10/docs",previous:{title:"Mont\xe9e de version de Centreon HA depuis Centreon 21.04",permalink:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/centreon-ha/upgrade-centreon-ha-from-21-04"},next:{title:"Mettre \xe0 jour MariaDB",permalink:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-mariadb"}},p={},c=[{value:"Pr\xe9requis",id:"pr\xe9requis",level:2},{value:"Informations importantes",id:"informations-importantes",level:3},{value:"P\xe9rim\xe8tre d&#39;application",id:"p\xe9rim\xe8tre-dapplication",level:3},{value:"Suppression du Cluster",id:"suppression-du-cluster",level:2},{value:"Mise \xe0 jour de MariaDB / MySQL",id:"mise-\xe0-jour-de-mariadb--mysql",level:2},{value:"Mise \xe0 jour des paquets Centreon",id:"mise-\xe0-jour-des-paquets-centreon",level:2},{value:"Cr\xe9er le cluster Centreon-HA",id:"cr\xe9er-le-cluster-centreon-ha",level:2},{value:"Finaliser la mont\xe9e de version",id:"finaliser-la-mont\xe9e-de-version",level:3}],d={toc:c},m="wrapper";function f(e){var{components:r}=e,n=i(e,["components"]);return(0,t.kt)(m,a(function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){o(e,r,n[r])}))}return e}({},d,n),{components:r,mdxType:"MDXLayout"}),(0,t.kt)("h2",{id:"pr\xe9requis"},"Pr\xe9requis"),(0,t.kt)("h3",{id:"informations-importantes"},"Informations importantes"),(0,t.kt)("p",null,"Cette proc\xe9dure est r\xe9serv\xe9e aux utilisateurs avanc\xe9s. Il est conseill\xe9 de la lire\nde mani\xe8re compl\xe8te avant de d\xe9marrer toutes op\xe9rations. "),(0,t.kt)("p",null,"Il est n\xe9cessaire de comprendre globalement les diff\xe9rentes \xe9tapes afin de minimiser\nl'interruption de service g\xe9n\xe9r\xe9e lors de son application en production. "),(0,t.kt)("h3",{id:"p\xe9rim\xe8tre-dapplication"},"P\xe9rim\xe8tre d'application"),(0,t.kt)("p",null,"Cette proc\xe9dure vise \xe0 donner les bons pointeurs pour r\xe9aliser une migration depuis une\nversion de Centreon < 20.04 hautement disponible gr\xe2ce \xe0 la solution centreon-failover."),(0,t.kt)("p",null,"Si vous n'avez jamais sollicit\xe9 Centreon ou l'un de ses partenaires, vous n'\xeates probablement\npas concern\xe9 par le contenu de cette documentation. "),(0,t.kt)("p",null,"Il est recommand\xe9 d'ouvrir un ticket au support afin d'assurer la compatibilit\xe9 de votre plateforme\navec les op\xe9rations d\xe9crites dans cette proc\xe9dure. "),(0,t.kt)("h2",{id:"suppression-du-cluster"},"Suppression du Cluster"),(0,t.kt)("p",null,"Afin de passer de centreon-failover \xe0 centreon-ha, il est n\xe9cessaire de d\xe9truire le cluster\nexistant. L'interface Web de Centreon est indisponible durant toute la dur\xe9e de la mise \xe0 jour\net ce jusqu'\xe0 la cr\xe9ation d'un nouveau Cluster. "),(0,t.kt)("p",null,"Connectez-vous en SSH \xe0 un noeud du cluster et ex\xe9cutez les commandes ci-apr\xe8s. "),(0,t.kt)("p",null,"D\xe9sactivez les ressources: "),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"pcs resource disable ms_mysql\npcs resource disable centreon\npcs resource unmanage centreon\npcs resource unmanage ms_mysql\n")),(0,t.kt)("p",null,"D\xe9truisez le cluster: "),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"pcs cluster destroy\n")),(0,t.kt)("p",null,"\xc0 ce moment, aucun des processus applicatifs g\xe9r\xe9s par le cluster ne doivent fonctionner. "),(0,t.kt)("p",null,"Stoppez manuellement la partie RRD de Centreon-Broker via la commande suivante: "),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"service cbd stop\n")),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},(0,t.kt)("strong",{parentName:"p"},"ATTENTION:")," Il est important de v\xe9rifier qu'aucun processus n'est en cours d'ex\xe9cution. Faites \xe9galement\nla v\xe9rification sur les serveurs de bases de donn\xe9es s'ils sont d\xe9di\xe9s.  ")),(0,t.kt)("h2",{id:"mise-\xe0-jour-de-mariadb--mysql"},"Mise \xe0 jour de MariaDB / MySQL"),(0,t.kt)("p",null,"Centreon est compatible avec la version 10.5 de MariaDB depuis la version 21.10. "),(0,t.kt)("p",null,"R\xe9alisez la mont\xe9e de version des bases de donn\xe9es en suivant ",(0,t.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-from-19-10#mont%C3%A9e-de-version-du-serveur-mariadb"},"la documentation officielle"),". "),(0,t.kt)("p",null,"Un fois la mise \xe0 jour r\xe9alis\xe9e sur chaque noeud, arr\xeater les processus via les commandes suivantes: "),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl stop mysql mariadb\n")),(0,t.kt)("h2",{id:"mise-\xe0-jour-des-paquets-centreon"},"Mise \xe0 jour des paquets Centreon"),(0,t.kt)("p",null,"Effectuer les op\xe9rations suivantes sur les deux noeuds h\xe9bergeant le serveur Apache et l'applicatif Centreon:"),(0,t.kt)("p",null,"Si vous utilisez Centreon 19.10:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-from-19-10#mise-%C3%A0-jour-des-d%C3%A9p%C3%B4ts"},"D\xe9ployer les d\xe9p\xf4ts 21.10"),". Il est \xe9galement n\xe9cessaire de mettre \xe0 jour les d\xe9p\xf4ts des modules de l'\xe9dition Business."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-from-19-10#mont%C3%A9e-de-version-de-la-solution-centreon"},"Mettre \xe0 jour les paquets Centreon")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-from-19-10#actions-compl%C3%A9mentaires"},"R\xe9aliser les \xe9tapes suppl\xe9mentaires"))),(0,t.kt)("p",null,"Si vous utilisez Centreon 19.04:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-from-19-04#mise-%C3%A0-jour-des-d%C3%A9p%C3%B4ts"},"D\xe9ployer les d\xe9p\xf4ts 21.10"),". Also those of the Business Edition modules if installed."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-from-19-04#mont%C3%A9e-de-version-de-la-solution-centreon"},"Mettre \xe0 jour les paquets Centreon")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-from-19-04#actions-compl%C3%A9mentaires"},"R\xe9aliser les \xe9tapes suppl\xe9mentaires"))),(0,t.kt)("p",null,"\xc0 la suite de ces op\xe9rations, stoppez le processus apache et contr\xf4lez \xe0 nouveau qu'aucun processus g\xe9r\xe9 par le Cluster\nn'est en cours d'ex\xe9cution. "),(0,t.kt)("h2",{id:"cr\xe9er-le-cluster-centreon-ha"},"Cr\xe9er le cluster Centreon-HA"),(0,t.kt)("p",null,"En fonction de l'architecture utilis\xe9e, la proc\xe9dure pour installer et configurer le Cluster diff\xe8re: "),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Si Centreon et les bases de donn\xe9es sont sur le m\xeame noeud, suivez ce ",(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/installation/installation-of-centreon-ha/installation-2-nodes#mise-en-place-du-cluster-centreon"},"guide d'installation")),(0,t.kt)("li",{parentName:"ul"},"Si les bases de donn\xe9es tournent sur un serveur d\xe9di\xe9, suivez ce ",(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/installation/installation-of-centreon-ha/installation-4-nodes#mise-en-place-du-cluster-centreon"},"guide d'installation"))),(0,t.kt)("p",null,"Avant de passer \xe0 la finalisation de la mise \xe0 jour, assurez-vous que toutes les ressources fonctionnent correctement sans erreurs. "),(0,t.kt)("p",null,"Si ce n'est pas le cas, il est recommand\xe9 de v\xe9rifier les \xe9l\xe9ments suivants:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/installation/installation-of-centreon-ha/installation-2-nodes#%C3%A9changes-de-clefs-ssh"},"\xc9changes de clefs SSH pour le Cluster")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/installation/installation-of-centreon-ha/installation-2-nodes#cr%C3%A9ation-du-compte-centreon"},"Droits et privil\xe8ges des utilisateurs de bases de donn\xe9es"))),(0,t.kt)("p",null,"Une fois que les clefs SSH des utilisateurs centreon et mysql ont bien \xe9t\xe9 \xe9chang\xe9es, il est recommand\xe9\nde supprimer la clef publique de root de /root/.ssh/authorized_keys."),(0,t.kt)("h3",{id:"finaliser-la-mont\xe9e-de-version"},"Finaliser la mont\xe9e de version"),(0,t.kt)("p",null,"Vous pouvez d\xe9sormais finaliser la mise \xe0 jour de Centreon via l'assistant web: "),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Si vous \xe9tiez en version 19.10, suivez ce ",(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-from-19-10#finalisation-de-la-mise-%C3%A0-jour"},"chapitre"),"."),(0,t.kt)("li",{parentName:"ul"},"Si vous \xe9tiez en version 19.04, suivez ce ",(0,t.kt)("a",{parentName:"li",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-from-19-04#finalisation-de-la-mise-%C3%A0-jour"},"chapitre"),".")),(0,t.kt)("p",null,"Ensuite, v\xe9rifiez que la commande de rechargement de Centreon-Broker pour le Serveur Central int\xe8gre bien la modification\nd\xe9crite ",(0,t.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/installation/installation-of-centreon-ha/installation-2-nodes#modification-de-la-commande-de-rechargement-de-cbd"},"ici"),". Celle-ci est configurable via le menu\n'Configuration > Collecteurs'. "),(0,t.kt)("p",null,"Enfin, ",(0,t.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2668/fr/docs/21.10/upgrade/upgrade-from-19-04#mont%C3%A9e-de-version-des-pollers"},"mettez \xe0 jour les Pollers"),", red\xe9ployez la configuration et red\xe9marrez le processus centengine."))}f.isMDXComponent=!0}}]);